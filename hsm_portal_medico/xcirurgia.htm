<!DOCTYPE html>
<html>
    <head>
        <title>teste</title>
        <meta charset="utf-8" name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, minimal-ui">
        <link rel="icon" href="images/mielina.ico">
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Material+Icons">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/vuetify/1.0.3/vuetify.min.css">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.5.13/vue.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/vue-resource/1.3.6/vue-resource.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/vuetify/1.0.3/vuetify.min.js"></script>

        <script src="js/lib/jquery.js"></script>
        <script src="js/lib/jquery.soap.js"></script>
        <script src="js/lib/xml2json.js"></script>
    </head>
    <body>
        <div id="vue_app">
            <v-app id="inspire">
                <span v-bind:title="message">
                    Pare o mouse sobre mim e veja a dica interligada dinamicamente!
                </span>
                <table>
                    <tr v-for="tes in issues">
                        <td>{{tes.Codigo}}</td>
                        <td>{{tes.Nome}}</td>
                    </tr>
                </table>        
            </v-app>
            <script>
                JSON_parse = function(str) {
                    str = str.replace('<?xml version="1.0" encoding="utf-8"?>', '')
                    str = str.replace('<string xmlns="http://www.example.org/">', '')
                    str = str.replace('</string>', '')
                    return JSON.parse(str)
                }
                    
                var vm = new Vue({
                    el: '#vue_app',
                    data () {
                        return {
                            message: 'Você carregou esta página em ' + new Date().toLocaleString(),
                            issues:[]
                        }
                    },
                    created: function() {
                        $.soap({
                            url: 'http://127.0.0.1:8080/paciente.asmx/',
                            method: 'getEstadoCivil',
                            data: {},
                            success: function (soapResponse) { 
                                vm.issues = JSON_parse(soapResponse.toString())
                            },
                            error: function (SOAPResponse) {
                                console.dir(SOAPResponse)
                            }
                        })
                    }
                })
            </script>
        </div>
    </body>
</html>
